# Линайная алгебра и геометрия. ИДЗ №4(вариант 21)

## Выполнил студент Наседкин Дмитрий Сергеевич (группа 242)

### №1

Нам даны 3 матрицы:

$$
A = \begin{pmatrix}
4 & 3 & 1 & -3 \\
-5 & -5 & -1 & 2 \\
-5 & -2 & -4 & 2 \\
9 & 4 & 1 & -7
\end{pmatrix}, \quad
B = \begin{pmatrix}
-4 & -3 & 1 & -1 \\
1 & 1 & -1 & 2 \\
1 & 4 & -4 & 2 \\
-1 & -4 & 1 & -5
\end{pmatrix} \quad \text{и} \quad
C = \begin{pmatrix}
-4 & -4 & -2 & 1 \\
1 & 3 & 3 & -2 \\
-1 & -8 & -7 & 3 \\
1 & 4 & 2 & -4
\end{pmatrix}
$$

Нужно проверить, что какие из них задают один и тот же линейный оператор, но в разных базисах, то есть проверить сопряжены ли матрицы. (то есть $A = D^{-1}BD$, где $D$ - невырожденная матрица). По утв. 131 это эквивалентно тому, что:

1) Их характеристические многочлены равны между собой: $\chi_A(\lambda) = \chi_B(\lambda)$.
2) Для любого корня $\lambda$ характеристического многочлена и любого числа $k$ не превосходящего кратности $\lambda$ выполнено $rk(A − \lambda E)^k = rk(B − \lambda E)^k$

При этом заметим, что достаточно проверить все $k \leq \lfloor \frac{n_i}{2} \rfloor$, где $n_i$ - кратность корня. (Это следует из того, что по сути мы проверяем, что у них жордановы клетки для одного собственного значения, но если что это было и на семе и на лекции).

Найдем их хар. многочлены:

Для матрицы $A$:

$$
\det(A - x E) = \det
\begin{pmatrix}
4 - x & 3 & 1 & -3 \\
-5 & -5 - x & -1 & 2 \\
-5 & -2 & -4 - x & 2 \\
9 & 4 & 1 & -7 - x
\end{pmatrix}
= \det
\begin{pmatrix}
4 - x & 3 & 1 & -3 \\
-5 & -5 - x & -1 & 2 \\
0 & 3 + x & -3 - x & 0 \\
5 + x & 1 & 0 & -4 - x
\end{pmatrix}
= \det
\begin{pmatrix}
-1 - x & -2 - x & 0 & -1 \\
-5     & -5 - x & -1 & 2 \\
0      & 3 + x  & -3 - x & 0 \\
5 + x  & 1      & 0      & -4 - x
\end{pmatrix}
$$

Найдем определитель через формулу разложения по третьей строке:

$$
det(A - x E) = -(3 + x)\det
\begin{pmatrix}
-1 - x & 0 & -1 \\
-5 & -1 & 2 \\
5 + x & 0 & -4 - x
\end{pmatrix} + (-3 - x)\det
\begin{pmatrix}
-1 - x & -2 - x & -1 \\
-5 & -5 - x & 2 \\
5 + x  & 1 & -4 - x
\end{pmatrix}
= (x + 3)(x^2 + 6x + 9) + (x + 3)(x^3 + 8x^2 + 21x + 18) = (x + 3)^3 + (x + 3)^3(x + 2) = (x + 3)^4.
$$

Я верю, что у матрицы $B, C$ такой же хар. многочлен(иначе это не интересная задача), да и видим, что у них следы совпадают, а значит сумма корней в хар. многочлене одинаковая, поэтому давайте лишь проверим наше предположение, для этого можно сделать следующее:

- Проверим, что $\lambda = -3 \in \text{spec} \ B, \text{spec} \ C$
- Проверим, что $\chi_A(B) = 0$ и $\chi_A(C) = 0$.

Для $B$:

$$
B + 3E =
\begin{pmatrix}
-4 + 3 & -3 & 1 & -1 \\
1 & 1 + 3 & -1 & 2 \\
1 & 4 & -4 + 3 & 2 \\
-1 & -4 & 1 & -5 + 3
\end{pmatrix} = 
\begin{pmatrix}
-1 & -3 & 1 & -1 \\
1 & 4 & -1 & 2 \\
1 & 4 & -1 & 2 \\
-1 & -4 & 1 & -2
\end{pmatrix} \Rightarrow B + 3E \text{ вырождена} \Rightarrow \lambda = -3 \in \text{spec} \ B
$$

$$
\chi_A(B) = (B + 3)^4 = 
\begin{pmatrix}
-1 & -3 & 1 & -1 \\
1 & 4 & -1 & 2 \\
1 & 4 & -1 & 2 \\
-1 & -4 & 1 & -2
\end{pmatrix}^4 =
\begin{pmatrix}
0 & -1 & 0 & -1 \\
0 & 1 & 0 & 1 \\
0 & 1 & 0 & 1 \\
0 & -1 & 0 & -1
\end{pmatrix}^2 = 
\begin{pmatrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0
\end{pmatrix} \Rightarrow \chi_B(\lambda) = (\lambda + 3)^4
$$

Для $C$:

$$
C + 3E =
\begin{pmatrix}
-4 + 3 & -4 & -2 & 1 \\
1 & 3 + 3 & 3 & -2 \\
-1 & -8 & -7 + 3 & 3 \\
1 & 4 & 2 & -4 + 3
\end{pmatrix} = 
\begin{pmatrix}
-1 & -4 & -2 & 1 \\
1 & 6 & 3 & -2 \\
-1 & -8 & -4 & 3 \\
1 & 4 & 2 & -1
\end{pmatrix} \Rightarrow С + 3E \text{ вырождена} \Rightarrow \lambda = -3 \in \text{spec} \ С
$$

$$
\chi_A(C) = (C + 3)^4 = 
\begin{pmatrix}
-1 & -4 & -2 & 1 \\
1 & 6 & 3 & -2 \\
-1 & -8 & -4 & 3 \\
1 & 4 & 2 & -1
\end{pmatrix}^4 =
\begin{pmatrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0
\end{pmatrix}^2 = 
\begin{pmatrix}
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0
\end{pmatrix} \Rightarrow \chi_C(\lambda) = (\lambda + 3)^4
$$

То есть первый пункт из утверждения для всех матриц верный, проверим теперь второй(то есть будем сверять ранги):

Вообще, уже видно, что $C$ и $B$ точно не задают один линейный оператор, так как $rk(C + 3E)^2 = 0 \neq rk(B + 3E)^2$.

$$
rk(A + 3E) = rk
\begin{pmatrix}
7 & 3 & 1 & -3 \\
-5 & -2 & -1 & 2 \\
-5 & -2 & -1 & 2 \\
9 & 4 & 1 & -4
\end{pmatrix} = 2
$$

$$
rk(A + 3E)^2 = rk
\begin{pmatrix}
7 & 3 & 1 & -3 \\
-5 & -2 & -1 & 2 \\
-5 & -2 & -1 & 2 \\
9 & 4 & 1 & -4
\end{pmatrix}^2 = rk
\begin{pmatrix}
2 & 1 & 0 & -1 \\
-2 & -1 & 0 & 1 \\
-2 & -1 & 0 & 1 \\
2 & 1 & 0 & -1
\end{pmatrix} = 1
$$

Отсюда видно, что $A$ и $C$ точно не задают один линейный оператор, а вот $rk(B + 3E) = 2, rk(B + 3E)^2 = 1$, а значит по утв. они действительно задают один лин. оператор.

### №2

Видим блок нулей, а значит будет удобнее работать с нашей матрицей $6 \times 6$ как с блоками(назовем исходную матрицу $M$).

$$
M=\begin{pmatrix}
A & 0\\
B & C
\end{pmatrix},
$$

где

$$
A =
\begin{pmatrix}
4 & -3 & 2 \\
0 & 2 & 1 \\
0 & -2 & 5
\end{pmatrix}, \quad
B =
\begin{pmatrix}
-2 & 2 & 1 \\
-4 & 8 & 1 \\
2 & -4 & 2
\end{pmatrix}, \quad
C =
\begin{pmatrix}
2 & 1 & 0 \\
-4 & 6 & 0 \\
-1 & 1 & 3
\end{pmatrix}.
$$

Для начала найдем $\chi_M(\lambda) = det(M - \lambda E) = det \begin{pmatrix}A - \lambda E & 0 \\ B & C - \lambda E \end{pmatrix} = det(A - \lambda E) det(C - \lambda E)$. Последнее равенство верно как раз из-за угла нулей (док-во легко делается или обычным рассуждением из явной формулы, либо можно юзануть утв. 25 с лекций).

Раскроем определитель по формуле разложения по столбцу(для $A$ по первому, для $C$ по третьему):

$$
det(A - \lambda E) =
\begin{pmatrix}
4 - \lambda & -3 & 2 \\
0 & 2 - \lambda & 1 \\
0 & -2 & 5 - \lambda
\end{pmatrix} = (4 - \lambda)((2 - \lambda)(5 - \lambda) + 2) = (4 - \lambda)(10 - 7 \lambda + \lambda^2 + 2) = (4 - \lambda)(\lambda^2 - 7 \lambda + 12) = -(\lambda - 4)^2(\lambda - 3)
$$

$$
det(C - \lambda E) =
\begin{pmatrix}
2 - \lambda & 1 & 0 \\
-4 & 6 - \lambda & 0 \\
-1 & 1 & 3 - \lambda
\end{pmatrix} = (3 - \lambda)((2 - \lambda)(6 - \lambda) + 4) = (3 - \lambda)(\lambda^2 - 8\lambda + 16) = (3 - \lambda)(\lambda - 4)^2
$$

Таким образом, $\chi_M(\lambda) = (\lambda - 3)^2(\lambda - 4)^4$.

То есть мы знаем, что в ЖНФ суммарный размер всех клеток с $\lambda = 3$ равен 2, а суммарный размер клеток с $\mu = 4$ равен 4. Давайте вычислим число клеток с $\lambda$ и $\mu$, для этого нужно вычислить $\dim \ker(M - \lambda E)$ и $\dim \ker(M - \mu E)$ соответственно.

$$
M - 3E =
\begin{pmatrix}
1 & -3 & 2 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 & 0 & 0 \\
0 & -2 & 2 & 0 & 0 & 0 \\
-2 & 2 & 1 & -1 & 1 & 0 \\
-4 & 8 & 1 & -4 & 3 & 0 \\
2 & -4 & 2 & -1 & 1 & 0
\end{pmatrix} \sim
\begin{pmatrix}
1 & -3 & 2 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & -1 & 1 & 0 \\
0 & 0 & 0 & 1 & -2 & 0 \\
0 & 0 & 0 & 0 & -1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0
\end{pmatrix} \Rightarrow \dim \ker(M - \lambda E) = 1 \Rightarrow \text{В ЖНФ одна клетка со значением 3 размера 2}.
$$

$$
M - 4E =
\begin{pmatrix}
0 & -3 & 2 & 0 & 0 & 0 \\
0 & -2 & 1 & 0 & 0 & 0 \\
0 & -2 & 1 & 0 & 0 & 0 \\
-2 & 2 & 1 & -2 & 1 & 0 \\
-4 & 8 & 1 & -4 & 2 & 0 \\
2 & -4 & 2 & -1 & 1 & -1
\end{pmatrix} \sim
\begin{pmatrix}
-2 & 2 & 1 & -2 & 1 & 0 \\
0 & 4 & -1 & 0 & 0 & 0 \\
0 & -2 & 3 & -3 & 2 & -1 \\
0 & -3 & 2 & 0 & 0 & 0 \\
0 & -2 & 1 & 0 & 0 & 0
\end{pmatrix} \sim
\begin{pmatrix}
-2 & 2 & 1 & -2 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 2 & -3 & 2 & -1
\end{pmatrix} \Rightarrow \dim \ker(M - \mu E) = 2 \Rightarrow \text{В ЖНФ клетки со значением 4 это либо 1-3, либо 2-2}.
$$

Посчитаем кол-во клеток размера 1 со значением 4 по формуле: (утв. 130)

$$
2 \dim \ker(M - \mu E)^1 - \dim \ker(M - \mu E)^2 - \dim \ker(M - \mu E)^0 = 2 * 2 - \dim \ker(M - \mu E)^2 = 4 - \dim \ker(M - \mu E)^2 = 4 - 4 = 0 \Rightarrow \text{В ЖНФ клетки со значением 4 это 2 клетки размера 2}.
$$

Расчеты $\dim \ker(M - \mu E)^2$:

$$
(M - \mu E)^2 =
\begin{pmatrix}
A - \mu E & 0 \\
B & C - \mu E
\end{pmatrix}^2 =
\begin{pmatrix}
(A - \mu E)^2 & 0 \\
B(A - \mu E) + (C - \mu E)B & (C - \mu E)^2
\end{pmatrix} =
\begin{pmatrix}
0 & 2 & -1 & 0 & 0 & 0 \\
0 & 2 & -1 & 0 & 0 & 0 \\
0 & 2 & -1 & 0 & 0 & 0 \\
0 & 4 & -2 & 0 & 0 & 0 \\
0 & 2 & -1 & 0 & 0 & 0 \\
-4 & 8 & 0 & -1 & 0 & 1
\end{pmatrix} \Rightarrow \dim \ker(M - \mu E)^2 = 4
$$

Таким образом ЖНФ:

$$
J =
\begin{pmatrix}
3 & 1 & 0 & 0 & 0 & 0 \\
0 & 3 & 0 & 0 & 0 & 0 \\
0 & 0 & 4 & 1 & 0 & 0 \\
0 & 0 & 0 & 4 & 0 & 0 \\
0 & 0 & 0 & 0 & 4 & 1 \\
0 & 0 & 0 & 0 & 0 & 4
\end{pmatrix}
$$

Теперь найдем жорданов базис:

Для $\lambda$ чтобы найти $f_1$ давайте найдем какое-нибудь решение системы $(M - \lambda E)f_1 = 0$:

$$
M - \lambda E =
\begin{pmatrix}
1 & -3 & 2 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 & 0 & 0 \\
0 & -2 & 2 & 0 & 0 & 0 \\
-2 & 2 & 1 & -1 & 1 & 0 \\
-4 & 8 & 1 & -4 & 3 & 0 \\
2 & -4 & 2 & -1 & 1 & 0
\end{pmatrix} \sim
\begin{pmatrix}
1 & -3 & 2 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 & 0 & 0 \\
0 & 0 & 1 & -1 & 1 & 0 \\
0 & 0 & 0 & 1 & -2 & 0 \\
0 & 0 & 0 & 0 & -1 & 0 \\
0 & 0 & 0 & 0 & 0 & 0
\end{pmatrix} \Rightarrow \text{ ФСР системы } = (0, 0, 0, 0, 0, 1)^T \Rightarrow f_1 = (0, 0, 0, 0, 0, 1)^T
$$

Тогда чтобы найти $f_2$ нужно решить систему $(M - \lambda E)f_2 = f_1$:

$$
\begin{pmatrix}
\begin{array}{c c c c c c|c}
1 & -3 & 2 & 0 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 & 0 & 0 & 0 \\
0 & -2 & 2 & 0 & 0 & 0 & 0 \\
-2 & 2 & 1 & -1 & 1 & 0 & 0 \\
-4 & 8 & 1 & -4 & 3 & 0 & 0 \\
2 & -4 & 2 & -1 & 1 & 0 & 1
\end{array}
\end{pmatrix} \sim
\begin{pmatrix}
\begin{array}{c c c c c c|c}
1 & -3 & 2 & 0 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & -1 & 1 & 0 & 0 \\
0 & 0 & 0 & 1 & -2 & 0 & 0 \\
0 & 0 & 0 & 0 & -1 & 0 & 1 \\
\end{array}
\end{pmatrix} \sim
\begin{pmatrix}
\begin{array}{c c c c c c|c}
1 & 0 & 0 & 0 & 0 & 0 & -1 \\
0 & -1 & 0 & 0 & 0 & 0 & 1 \\
0 & 0 & 1 & 0 & 0 & 0 & -1 \\
0 & 0 & 0 & 1 & 0 & 0 & -2 \\
0 & 0 & 0 & 0 & -1 & 0 & 1 \\
\end{array}
\end{pmatrix} \Rightarrow f_2 = (-1, -1, -1, -2, -1, 0)^T
$$

Теперь будем действовать аналогично для $\mu$ и таким образом найдем $f_3, f_4, f_5, f_6$:

$$
M - \mu E =
\begin{pmatrix}
0 & -3 & 2 & 0 & 0 & 0 \\
0 & -2 & 1 & 0 & 0 & 0 \\
0 & -2 & 1 & 0 & 0 & 0 \\
-2 & 2 & 1 & -2 & 1 & 0 \\
-4 & 8 & 1 & -4 & 2 & 0 \\
2 & -4 & 2 & -1 & 1 & -1
\end{pmatrix} \sim
\begin{pmatrix}
-2 & 2 & 1 & -2 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 2 & -3 & 2 & -1
\end{pmatrix} \sim
\begin{pmatrix}
-2 & 2 & 1 & -2 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & -3 & 2 & -1
\end{pmatrix} \sim
\begin{pmatrix}
-2 & 2 & 1 & -2 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & -3 & 2 & -1
\end{pmatrix} \sim
\begin{pmatrix}
6 & 0 & 0 & 0 & 1 & -2 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 3 & -2 & 1
\end{pmatrix}
$$

Тогда ФСР:

$$
\begin{array}{}
f_3 = (*, *, *, *, 6, 0)^T = (-1, 0, 0, 4, 6, 0)^T \\[6pt]
f_5 = (*, *, *, *, 0, 6)^T = (1, 0, 0, -1, 0, 3)^T
\end{array}
$$

Решим $(M - \mu E)f_4 = f_3$ и $(M - \mu E)f_6 = f_5$:

$$
\begin{pmatrix}
\begin{array}{c c c c c c|c c}
0 & -3 & 2 & 0 & 0 & 0 & -1 & 1\\
0 & -2 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & -2 & 1 & 0 & 0 & 0 & 0 & 0\\
-2 & 2 & 1 & -2 & 1 & 0 & 4 & -1\\
-4 & 8 & 1 & -4 & 2 & 0 & 6 & 0\\
2 & -4 & 2 & -1 & 1 & -1 & 0 & 3
\end{array}
\end{pmatrix} \sim
\begin{pmatrix}
\begin{array}{c c c c c c|c c}
-2 & 2 & 1 & -2 & 1 & 0 & 4 & -1 \\
0 & -2 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & -3 & 2 & 0 & 0 & 0 & -1 & 1 \\
0 & 4 & -1 & 0 & 0 & 0 & -2 & 2 \\
0 & -2 & 3 & -3 & 2 & -1 & 4 & 2
\end{array}
\end{pmatrix} \sim
\begin{pmatrix}
\begin{array}{c c c c c c|c c}
-2 & 2 & 1 & -2 & 1 & 0 & 4 & -1 \\
0 & -2 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & -2 & 2 \\
0 & 0 & 1 & 0 & 0 & 0 & -2 & 2 \\
0 & 0 & 2 & -3 & 2 & -1 & 4 & 2
\end{array}
\end{pmatrix} \sim
$$

$$
\sim
\begin{pmatrix}
\begin{array}{c c c c c c|c c}
-2 & 2 & 1 & -2 & 1 & 0 & 4 & -1 \\
0 & -2 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & -2 & 2 \\
0 & 0 & 0 & -3 & 2 & -1 & 8 & -2 \\
\end{array}
\end{pmatrix} \sim
\begin{pmatrix}
\begin{array}{c c c c c c|c c}
1 & 0 & 0 & 0 & \tfrac{1}{6} & -\tfrac{1}{3} & -\tfrac{4}{3} & \tfrac{11}{6}\\[6pt]
0 & 1 & 0 & 0 & 0 & 0 & -1 & 1 \\[6pt]
0 & 0 & 1 & 0 & 0 & 0 & -2 & 2 \\[6pt]
0 & 0 & 0 & 1 & -\tfrac{2}{3} & \tfrac{1}{3}  & -\tfrac{8}{3} & \tfrac{2}{3}
\end{array}
\end{pmatrix} \Rightarrow \begin{array}{c c}
f_4 = (\frac{-4}{3},& -1,& -2,& \frac{-8}{3},& 0,& 0)^T \\[6pt]
f_6 = (\frac{11}{6},& 1,& 2,& \frac{2}{3},& 0,& 0)^T
\end{array}
$$

Таким образом матрица перехода имеет вид:

$$
S =
\begin{pmatrix}
0 & -1 & -1 & -\frac{4}{3} & 1 & \frac{11}{6}\\[6pt]
0 & -1 & 0 & -1 & 0 & 1\\[6pt]
0 & -1 & 0 & -2 & 0 & 2\\[6pt]
0 & -2 & 4 & -\frac{8}{3} & -1 & \frac{2}{3}\\[6pt]
0 & -1 & 6 & 0 & 0 & 0\\[6pt]
1 & 0 & 0 & 0 & 3 & 0
\end{pmatrix}
$$

### №3

**Переход в стандартный базис**:

Найдем матрицы перехода:

$$
G = (g_1 \;|\; g_2 \;|\; g_3)
=\begin{pmatrix}
-1 & -2 & -1\\
-1 & -3 & -2\\
-1 & -4 & -4
\end{pmatrix},\quad
H = (f_1 \;|\; f_2 \;|\; f_3)
=\begin{pmatrix}
1 & -1 & 1\\
-2 & 3  & -4\\
-1 & 2  & -4
\end{pmatrix}.
$$

Найдем обратные к ним матрицы:

$$
G^{-1} = \frac{\hat{G}}{\det(G)} = \frac{1}{-4+4-1}
\begin{pmatrix}
4 & -4 & 1\\
-2 & 3 & -1\\
1 & -2 & 1
\end{pmatrix} = 
\begin{pmatrix}
-4 & 4 & -1 \\
2 & -3 & 1 \\
-1 & 2 & -1
\end{pmatrix}
$$

$$
H^{-1} = \frac{\hat{H}}{\det(H)} = -
\begin{pmatrix}
-4 & -2 & 1 \\
-4 & -3 & 2 \\
-1 & -1 & 1
\end{pmatrix} = 
\begin{pmatrix}
4 & 2 & -1 \\
4 & 3 & -2 \\
1 & 1 & -1
\end{pmatrix}
$$

Найдем матрицы операторов в стандартном базисе:

$$
A_e \;=\; G\,A\,G^{-1},
\qquad
B_e \;=\; H\,B\,H^{-1},
$$

$$
A_e
=\begin{pmatrix}
-1 & -2 & -1 \\
-1 & -3 & -2 \\
-1 & -4 & -4
\end{pmatrix}
\begin{pmatrix}
4 & 7 & 0 \\
-2 & -1 & 5 \\
2 & 2 & -3
\end{pmatrix}
\begin{pmatrix}
-4 & 4 & -1 \\
2 & -3 & 1 \\
-1 & 2 & -1
\end{pmatrix} =
\begin{pmatrix}
-2 & -7 & -7 \\
-2 & -8 & -9 \\
-4 & -11 & -8
\end{pmatrix}
\begin{pmatrix}
-4 & 4 & -1 \\
2 & -3 & 1 \\
-1 & 2 & -1
\end{pmatrix} =
\begin{pmatrix}
1 & -1 & 2 \\
1 & -2 & 3 \\
2 & 1 & 1
\end{pmatrix}
$$

$$
B_e =
\begin{pmatrix}
1 & -1 & 1 \\
-2 & 3 & -4 \\
-1 & 2 & -4
\end{pmatrix}
\begin{pmatrix}
3 & -1 & -6 \\
3 & -5 & 6 \\
1 & -3 & 6
\end{pmatrix}
\begin{pmatrix}
4 & 2 & -1 \\
4 & 3 & -2 \\
1 & 1 & -1
\end{pmatrix} =
\begin{pmatrix}
1 & 1 & -6 \\
-1 & -1 & 6 \\
-1 & 3 & -6
\end{pmatrix}
\begin{pmatrix}
4 & 2 & -1 \\
4 & 3 & -2 \\
1 & 1 & -1
\end{pmatrix} =
\begin{pmatrix}
2 & -1 & 3 \\
-2 & 1 & -3 \\
2 & 1 & 1
\end{pmatrix}
$$

---

**Матрица композиции $\varphi\circ\psi$ в стандартном базисе**:

Если матрицы операторов для одного базиса, то композиция будет соответствовать:

$$
[\varphi\circ\psi]_e
= A_eB_e = \begin{pmatrix}
1 & -1 & 2 \\
1 & -2 & 3 \\
2 & 1 & 1
\end{pmatrix}
\begin{pmatrix}
2 & -1 & 3 \\
-2 & 1 & -3 \\
2 & 1 & 1
\end{pmatrix} =
\begin{pmatrix}
8 & 0 & 8 \\
12 & 0 & 12 \\
4 & 0 & 4
\end{pmatrix}
$$

---

Далее алгоритм следующий:

- Найдем для каждого из операторов ее образ и ядро
- Выполним пункт б
- Выполним пункт в

**Замечание**:

Делать все это именно для операторов в одном базисе(В нашем случае в стандартном).

**$\ker\varphi$ и $\ker\psi$**:

Нужно найти ФСР системы $A_ex=0$ и $B_ex=0$, ФСР и будет базисом ядра:

$$
A_e = 
\begin{pmatrix}
1 & -1 & 2 \\
1 & -2 & 3 \\
2 & 1 & 1
\end{pmatrix} \sim
\begin{pmatrix}
1 & -1 & 2 \\
0 & -1 & 1 \\
\end{pmatrix} \sim
\begin{pmatrix}
1 & 0 & 1 \\
0 & 1 & -1 \\
\end{pmatrix}
$$

Тогда $\ker \varphi = \langle (-1, \; 1, \; 1) \rangle$:

$$
B_e =
\begin{pmatrix}
2 & -1 & 3 \\
-2 & 1 & -3 \\
2 & 1 & 1
\end{pmatrix} \sim
\begin{pmatrix}
2 & -1 & 3 \\
0 & 2 & -2
\end{pmatrix} \sim
\begin{pmatrix}
1 & 0 & 1 \\
0 & 1 & -1
\end{pmatrix}
$$

Тогда $\ker \psi = \langle (-1, \; 1, \; 1) \rangle$:

**$Im \ \varphi$ и $Im \ \psi$**:

Столбцы $A_e$ порождают $Im \ \varphi$, а $B_e$ — $Im \ \psi$.
Тогда базис $Im \ \varphi$ равен $(1, \; 1, \; 2), (-1, \; -2, \; 1)$ (первый и второй столбец $A$), а базис $Im \ \psi$ равен $(2, \; -2, \; 2), (-1, \; 1, \; 1)$ (тоже первый и второй столбец, только теперь $B$).

**Базис пространства $\ker\varphi + \ker\psi$**

Так как $\ker \varphi = \ker \psi = \langle (-1, \; 1, \; 1) \rangle \Rightarrow \ker \varphi + \ker \psi = \langle (-1, \; 1, \; 1) \rangle$.

**Базис пространства $Im \ \varphi\cap Im \ \psi$**

Воспользуемся алгоритмом из гита Димы(№ 13):

$$
v_1 = (1, \; 1, \; 2),\; v_2 = (-1, \; -2, \; 1),
\qquad
u_1 = (2, \; -2, \; 2),\; u_2 = (-1, \; 1, \; 1)
$$

Собираем систему

$$
\bigl(v_1\;v_2\;|\;u_1\;u_2\bigr)
\begin{pmatrix}
\alpha_1 \\
\alpha_2 \\
\beta_1 \\
\beta_2
\end{pmatrix}
= 0
$$

и находим ФСР:

$$
\begin{pmatrix}
1 & -1 & 2 & -1\\
1 & -2 & -2 & 1\\
2 & 1 & 2 & 1
\end{pmatrix} \sim
\begin{pmatrix}
1 & -1 & 2 & -1 \\
0 & -1 & -4 & 2 \\
0 & 0 & -14 & 9
\end{pmatrix}
$$

$$
x = (-12, \; -8, \; 9, \; 14)^T
$$

$(\beta_1,\beta_2)=(9 ,\; 14)$.
Тогда

$$
R' \;=\; [\,u_1\;u_2\,]\,
\begin{pmatrix}
9\\
14
\end{pmatrix}
= 9u_1 + 14u_2
= 9(2, \; -2, \; 2)^T + 14(-1, \; 1, \; 1)^T
= (4, \, -4, \, 32)^T.
$$

Получили ровно **один** вектор, значит $\dim(Im \ \varphi \cap Im \ \psi)=1$, а значит он базисный. То есть:

$$
Im \ \varphi \cap Im \ \psi= \langle (1, \, -1, \, 8)^T \rangle.
$$

### №4

Нам дана матрица:

$$
A_t =
\begin{pmatrix}
-2 & 0 & 1 & t - 1 & 0 \\
0 & -2 & 0 & 0 & 0 \\
0 & t & -2 & 0 & 1 + t \\
0 & 0 & 0 & 3 & 0 \\
0 & 0 & 0 & 1 & 3
\end{pmatrix}
$$

Не зря задачи все таки на ЖНФ, поэтому давайте приведем $A_t$ к ЖНФ, тогда получим, что $A_t = PJP^{-1}$, где $P$ - матрица перехода от стандартного базиса к тому, в котором $J$ - ЖНФ.

Давайте ~~зачем-то~~ найдем матрицы все матрицы $D$, которые коммутируют с J(потому что их легко найти) и диагонализуемые, тогда какая связь вообще с тем, что $[A_t, X] = 0$ (коммутатор), и $X$ - диагональна?

Так как мы нашли $D$, которые записаны в том же базисе что и $J$, то теперь нужно перейти к стандартному базису, чтобы вернуться к $A_t$, то есть $X = PDP^{-1}$. Тогда если мы докажем, что $[A_t, X] = 0$ и $X$ - диагонализуема(и в обратную сторону), то получим, что $\dim L_t = \dim K_t$, где $K_t$ - подпространство матриц порожденное всеми нашими подходящими $D$.

#### 1) Диагонализуемость $X \iff$ диагонализуемость $D$

  Матрицы сопряжены, значит у них одна структура ЖНФ, а значит из диагонализуемости одной следует диагонализуемость другой.

#### 2) $[A_t, X] = 0 \iff [J, D] = 0$

$\Longleftarrow$

$$
XA_t = (PDP^{-1})A_t = PD(P^{-1}A_tP)P^{-1} = PDJP^{-1} = PJDP^{-1} = (PJP^{-1})(PDP^{-1}) = A_tX
$$

$\Longrightarrow$

$$
DJ = (P^{-1}XP)J = P^{-1}X(PJP^{-1})P = P^{-1}XA_tP = P^{-1}A_tXP = (P^{-1}A_tP)(P^{-1}XP) = JD
$$

---

Найдем ЖНФ $A_t$:

$\chi_{A_t}(\lambda) = (\lambda + 2)^3(\lambda - 3)^2$ (ищется совсем тривиально).

То есть у нас суммарных размер клеток с $\lambda = -2$ равен 3, а с $\lambda = 3$ равен 2. $\dim \ker(A_t - 3E) = 1 \Rightarrow$ для $\lambda = 3$ имеем один жорданов блок размера 2. С $\dim \ker(A_t + 2E)$ чуть сложней:

$$
A_t + 2E =
\begin{pmatrix}
0 & 0 & 1 & t-1 & 0 \\
0 & 0 & 0 & 0 & 0 \\
0 & t & 0 & 0 & t+1 \\
0 & 0 & 0 & 5 & 0 \\
0 & 0 & 0 & 1 & 5
\end{pmatrix} \sim

\begin{cases}
    \begin{pmatrix}
    0 & 0 & 1 & -1 & 0 \\
    0 & 0 & 0 & 5 & 0 \\
    0 & 0 & 0 & 0 & 1 \\
    0 & 0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 & 0
    \end{pmatrix},     \;  t = 0 \Rightarrow \dim \ker (A_t + 2E) = 2 \\[40pt]
    \begin{pmatrix}
    0 & t & 0 & 0 & t+1 \\
    0 & 0 & 1 & t-1 & 0 \\
    0 & 0 & 0 & 5 & 0 \\
    0 & 0 & 0 & 0 & 5 \\
    0 & 0 & 0 & 0 & 0
    \end{pmatrix},     \;  t \neq 0 \Rightarrow \dim \ker(A_t + 2E) = 1
\end{cases}$$

Тогда при $t = 0$ получаем, что клетки будут размера 1-2, и при $t \neq 0$ получаем, что будет одна клетка размера 3.

---

Как выглядят все матрицы $D$, что коммутируют с ЖНФ? (Это было на одном из семов), это будут блочно-диагональные матрицы такие(блоки размера такого же что и в ЖНФ), что каждый блок коммутирует с жордановой клеткой этого блока. А коммутирование с жордановой клеткой тоже было в ДЗ, это будет матрица вида:

$$
\begin{pmatrix}
a_0   & a_1   & a_2   & \cdots & a_{n-1} \\
0     & a_0   & a_1   & \cdots & a_{n-2} \\
\vdots&\ddots&\ddots&\ddots & \vdots  \\
0     & \cdots& 0     & a_0    & a_1     \\
0     & \cdots& \cdots& 0      & a_0
\end{pmatrix}
$$

Чтобы $D$(конкретный блок) при этом был диагонализуемым, (так как $\chi_D(\lambda) = (\lambda - a_0)^n$), должно быть, что $\dim \ker(D - a_0E) = n \Rightarrow$ $D$ - скалярная матрица.

Тогда при $t = 0$:

$$
D =
\begin{pmatrix}
\begin{smallmatrix}a&0\\0&a\end{smallmatrix} 
&0&0\\
0&c&0\\
0&0&
\begin{smallmatrix}d&0\\0&d\end{smallmatrix}
\end{pmatrix} \Rightarrow \dim K_0 = 3 = \dim L_0
$$

И при $t \neq 0$:

$$
D =
\begin{pmatrix}
\begin{matrix}a&0&0\\0&a&0\\0&0&a\end{matrix}
& 0\\
0&
\begin{smallmatrix}d&0\\0&d\end{smallmatrix}
\end{pmatrix} \Rightarrow \dim K_t = 2 = \dim L_t
$$

То есть наибольшая размерность $L_t$ достигается при $t = 0$.